<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<title>table_jsp xref</title>
<link type="text/css" rel="stylesheet" href="../../../../../../stylesheet.css" />
</head>
<body>
<div id="overview"><a href="../../../../../../../devapidocs/org/apache/hadoop/hbase/generated/master/table_jsp.html">View Javadoc</a></div><pre>

<a class="jxr_linenumber" name="1" href="#1">1</a>   <strong class="jxr_keyword">package</strong> org.apache.hadoop.hbase.generated.master;
<a class="jxr_linenumber" name="2" href="#2">2</a>   
<a class="jxr_linenumber" name="3" href="#3">3</a>   <strong class="jxr_keyword">import</strong> javax.servlet.*;
<a class="jxr_linenumber" name="4" href="#4">4</a>   <strong class="jxr_keyword">import</strong> javax.servlet.http.*;
<a class="jxr_linenumber" name="5" href="#5">5</a>   <strong class="jxr_keyword">import</strong> javax.servlet.jsp.*;
<a class="jxr_linenumber" name="6" href="#6">6</a>   <strong class="jxr_keyword">import</strong> <strong class="jxr_keyword">static</strong> org.apache.commons.lang.StringEscapeUtils.escapeXml;
<a class="jxr_linenumber" name="7" href="#7">7</a>   <strong class="jxr_keyword">import</strong> java.util.TreeMap;
<a class="jxr_linenumber" name="8" href="#8">8</a>   <strong class="jxr_keyword">import</strong> java.util.List;
<a class="jxr_linenumber" name="9" href="#9">9</a>   <strong class="jxr_keyword">import</strong> java.util.Map;
<a class="jxr_linenumber" name="10" href="#10">10</a>  <strong class="jxr_keyword">import</strong> java.util.Set;
<a class="jxr_linenumber" name="11" href="#11">11</a>  <strong class="jxr_keyword">import</strong> java.util.Collection;
<a class="jxr_linenumber" name="12" href="#12">12</a>  <strong class="jxr_keyword">import</strong> org.owasp.esapi.ESAPI;
<a class="jxr_linenumber" name="13" href="#13">13</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.conf.Configuration;
<a class="jxr_linenumber" name="14" href="#14">14</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.client.HTable;
<a class="jxr_linenumber" name="15" href="#15">15</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.client.Admin;
<a class="jxr_linenumber" name="16" href="#16">16</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.client.RegionLocator;
<a class="jxr_linenumber" name="17" href="#17">17</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.HRegionInfo;
<a class="jxr_linenumber" name="18" href="#18">18</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.HRegionLocation;
<a class="jxr_linenumber" name="19" href="#19">19</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.ServerName;
<a class="jxr_linenumber" name="20" href="#20">20</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.ServerLoad;
<a class="jxr_linenumber" name="21" href="#21">21</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.RegionLoad;
<a class="jxr_linenumber" name="22" href="#22">22</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.HConstants;
<a class="jxr_linenumber" name="23" href="#23">23</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.master.HMaster;
<a class="jxr_linenumber" name="24" href="#24">24</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.zookeeper.MetaTableLocator;
<a class="jxr_linenumber" name="25" href="#25">25</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.util.Bytes;
<a class="jxr_linenumber" name="26" href="#26">26</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.util.FSUtils;
<a class="jxr_linenumber" name="27" href="#27">27</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.protobuf.generated.AdminProtos.GetRegionInfoResponse.CompactionState;
<a class="jxr_linenumber" name="28" href="#28">28</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.TableName;
<a class="jxr_linenumber" name="29" href="#29">29</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.HColumnDescriptor;
<a class="jxr_linenumber" name="30" href="#30">30</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.client.RegionReplicaUtil;
<a class="jxr_linenumber" name="31" href="#31">31</a>  <strong class="jxr_keyword">import</strong> org.apache.hadoop.hbase.HBaseConfiguration;
<a class="jxr_linenumber" name="32" href="#32">32</a>  
<a class="jxr_linenumber" name="33" href="#33">33</a>  <strong class="jxr_keyword">public</strong> <strong class="jxr_keyword">final</strong> <strong class="jxr_keyword">class</strong> <a href="../../../../../../org/apache/hadoop/hbase/generated/master/table_jsp.html">table_jsp</a> <strong class="jxr_keyword">extends</strong> org.apache.jasper.runtime.HttpJspBase
<a class="jxr_linenumber" name="34" href="#34">34</a>      <strong class="jxr_keyword">implements</strong> org.apache.jasper.runtime.JspSourceDependent {
<a class="jxr_linenumber" name="35" href="#35">35</a>  
<a class="jxr_linenumber" name="36" href="#36">36</a>    <strong class="jxr_keyword">private</strong> <strong class="jxr_keyword">static</strong> <strong class="jxr_keyword">final</strong> JspFactory _jspxFactory = JspFactory.getDefaultFactory();
<a class="jxr_linenumber" name="37" href="#37">37</a>  
<a class="jxr_linenumber" name="38" href="#38">38</a>    <strong class="jxr_keyword">private</strong> <strong class="jxr_keyword">static</strong> java.util.Vector _jspx_dependants;
<a class="jxr_linenumber" name="39" href="#39">39</a>  
<a class="jxr_linenumber" name="40" href="#40">40</a>    <strong class="jxr_keyword">private</strong> org.apache.jasper.runtime.ResourceInjector _jspx_resourceInjector;
<a class="jxr_linenumber" name="41" href="#41">41</a>  
<a class="jxr_linenumber" name="42" href="#42">42</a>    <strong class="jxr_keyword">public</strong> Object getDependants() {
<a class="jxr_linenumber" name="43" href="#43">43</a>      <strong class="jxr_keyword">return</strong> _jspx_dependants;
<a class="jxr_linenumber" name="44" href="#44">44</a>    }
<a class="jxr_linenumber" name="45" href="#45">45</a>  
<a class="jxr_linenumber" name="46" href="#46">46</a>    <strong class="jxr_keyword">public</strong> <strong class="jxr_keyword">void</strong> _jspService(HttpServletRequest request, HttpServletResponse response)
<a class="jxr_linenumber" name="47" href="#47">47</a>          <strong class="jxr_keyword">throws</strong> java.io.IOException, ServletException {
<a class="jxr_linenumber" name="48" href="#48">48</a>  
<a class="jxr_linenumber" name="49" href="#49">49</a>      PageContext pageContext = <strong class="jxr_keyword">null</strong>;
<a class="jxr_linenumber" name="50" href="#50">50</a>      HttpSession session = <strong class="jxr_keyword">null</strong>;
<a class="jxr_linenumber" name="51" href="#51">51</a>      ServletContext application = <strong class="jxr_keyword">null</strong>;
<a class="jxr_linenumber" name="52" href="#52">52</a>      ServletConfig config = <strong class="jxr_keyword">null</strong>;
<a class="jxr_linenumber" name="53" href="#53">53</a>      JspWriter out = <strong class="jxr_keyword">null</strong>;
<a class="jxr_linenumber" name="54" href="#54">54</a>      Object page = <strong class="jxr_keyword">this</strong>;
<a class="jxr_linenumber" name="55" href="#55">55</a>      JspWriter _jspx_out = <strong class="jxr_keyword">null</strong>;
<a class="jxr_linenumber" name="56" href="#56">56</a>      PageContext _jspx_page_context = <strong class="jxr_keyword">null</strong>;
<a class="jxr_linenumber" name="57" href="#57">57</a>  
<a class="jxr_linenumber" name="58" href="#58">58</a>      <strong class="jxr_keyword">try</strong> {
<a class="jxr_linenumber" name="59" href="#59">59</a>        response.setContentType(<span class="jxr_string">"text/html;charset=UTF-8"</span>);
<a class="jxr_linenumber" name="60" href="#60">60</a>        pageContext = _jspxFactory.getPageContext(<strong class="jxr_keyword">this</strong>, request, response,
<a class="jxr_linenumber" name="61" href="#61">61</a>        			<strong class="jxr_keyword">null</strong>, <strong class="jxr_keyword">true</strong>, 8192, <strong class="jxr_keyword">true</strong>);
<a class="jxr_linenumber" name="62" href="#62">62</a>        _jspx_page_context = pageContext;
<a class="jxr_linenumber" name="63" href="#63">63</a>        application = pageContext.getServletContext();
<a class="jxr_linenumber" name="64" href="#64">64</a>        config = pageContext.getServletConfig();
<a class="jxr_linenumber" name="65" href="#65">65</a>        session = pageContext.getSession();
<a class="jxr_linenumber" name="66" href="#66">66</a>        out = pageContext.getOut();
<a class="jxr_linenumber" name="67" href="#67">67</a>        _jspx_out = out;
<a class="jxr_linenumber" name="68" href="#68">68</a>        _jspx_resourceInjector = (org.apache.jasper.runtime.ResourceInjector) application.getAttribute(<span class="jxr_string">"com.sun.appserv.jsp.resource.injector"</span>);
<a class="jxr_linenumber" name="69" href="#69">69</a>  
<a class="jxr_linenumber" name="70" href="#70">70</a>        out.write('\n');
<a class="jxr_linenumber" name="71" href="#71">71</a>        out.write('\n');
<a class="jxr_linenumber" name="72" href="#72">72</a>  
<a class="jxr_linenumber" name="73" href="#73">73</a>    <a href="../../../../../../org/apache/hadoop/hbase/master/HMaster.html">HMaster</a> master = (HMaster)getServletContext().getAttribute(HMaster.MASTER);
<a class="jxr_linenumber" name="74" href="#74">74</a>    Configuration conf = master.getConfiguration();
<a class="jxr_linenumber" name="75" href="#75">75</a>  
<a class="jxr_linenumber" name="76" href="#76">76</a>    <a href="../../../../../../org/apache/hadoop/hbase/zookeeper/MetaTableLocator.html">MetaTableLocator</a> metaTableLocator = <strong class="jxr_keyword">new</strong> <a href="../../../../../../org/apache/hadoop/hbase/zookeeper/MetaTableLocator.html">MetaTableLocator</a>();
<a class="jxr_linenumber" name="77" href="#77">77</a>    String fqtn = request.getParameter(<span class="jxr_string">"name"</span>);
<a class="jxr_linenumber" name="78" href="#78">78</a>    <a href="../../../../../../org/apache/hadoop/hbase/client/HTable.html">HTable</a> table = <strong class="jxr_keyword">null</strong>;
<a class="jxr_linenumber" name="79" href="#79">79</a>    String tableHeader;
<a class="jxr_linenumber" name="80" href="#80">80</a>    <strong class="jxr_keyword">boolean</strong> withReplica = false;
<a class="jxr_linenumber" name="81" href="#81">81</a>    <a href="../../../../../../org/apache/hadoop/hbase/ServerName.html">ServerName</a> rl = metaTableLocator.getMetaRegionLocation(master.getZooKeeper());
<a class="jxr_linenumber" name="82" href="#82">82</a>    <strong class="jxr_keyword">boolean</strong> showFragmentation = conf.getBoolean(<span class="jxr_string">"hbase.master.ui.fragmentation.enabled"</span>, false);
<a class="jxr_linenumber" name="83" href="#83">83</a>    <strong class="jxr_keyword">boolean</strong> readOnly = conf.getBoolean(<span class="jxr_string">"hbase.master.ui.readonly"</span>, false);
<a class="jxr_linenumber" name="84" href="#84">84</a>    <strong class="jxr_keyword">int</strong> numMetaReplicas = conf.getInt(HConstants.META_REPLICAS_NUM,
<a class="jxr_linenumber" name="85" href="#85">85</a>                          HConstants.DEFAULT_META_REPLICA_NUM);
<a class="jxr_linenumber" name="86" href="#86">86</a>    Map&lt;String, Integer&gt; frags = <strong class="jxr_keyword">null</strong>;
<a class="jxr_linenumber" name="87" href="#87">87</a>    <strong class="jxr_keyword">if</strong> (showFragmentation) {
<a class="jxr_linenumber" name="88" href="#88">88</a>        frags = FSUtils.getTableFragmentation(master);
<a class="jxr_linenumber" name="89" href="#89">89</a>    }
<a class="jxr_linenumber" name="90" href="#90">90</a>    String action = request.getParameter(<span class="jxr_string">"action"</span>);
<a class="jxr_linenumber" name="91" href="#91">91</a>    String key = request.getParameter(<span class="jxr_string">"key"</span>);
<a class="jxr_linenumber" name="92" href="#92">92</a>  
<a class="jxr_linenumber" name="93" href="#93">93</a>        out.write(<span class="jxr_string">"\n&lt;!--[if IE]&gt;\n&lt;!DOCTYPE html&gt;\n&lt;![endif]--&gt;\n&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot; ?&gt;\n&lt;html xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;\n  &lt;head&gt;\n    &lt;meta charset=\&quot;utf-8\&quot;&gt;\n    "</span>);
<a class="jxr_linenumber" name="94" href="#94">94</a>   <strong class="jxr_keyword">if</strong> ( !readOnly &amp;&amp; action != <strong class="jxr_keyword">null</strong> ) { 
<a class="jxr_linenumber" name="95" href="#95">95</a>        out.write(<span class="jxr_string">"\n        &lt;title&gt;HBase Master: "</span>);
<a class="jxr_linenumber" name="96" href="#96">96</a>        out.print( master.getServerName() );
<a class="jxr_linenumber" name="97" href="#97">97</a>        out.write(<span class="jxr_string">"&lt;/title&gt;\n    "</span>);
<a class="jxr_linenumber" name="98" href="#98">98</a>   } <strong class="jxr_keyword">else</strong> { 
<a class="jxr_linenumber" name="99" href="#99">99</a>        out.write(<span class="jxr_string">"\n        &lt;title&gt;Table: "</span>);
<a class="jxr_linenumber" name="100" href="#100">100</a>       out.print( ESAPI.encoder().encodeForHTML(fqtn) );
<a class="jxr_linenumber" name="101" href="#101">101</a>       out.write(<span class="jxr_string">"&lt;/title&gt;\n    "</span>);
<a class="jxr_linenumber" name="102" href="#102">102</a>  } 
<a class="jxr_linenumber" name="103" href="#103">103</a>       out.write(<span class="jxr_string">"\n    &lt;meta name=\&quot;viewport\&quot; content=\&quot;width=device-width, initial-scale=1.0\&quot;&gt;\n    &lt;meta name=\&quot;description\&quot; content=\&quot;\&quot;&gt;\n    &lt;meta name=\&quot;author\&quot; content=\&quot;\&quot;&gt;\n\n\n      &lt;link href=\&quot;/static/css/bootstrap.min.css\&quot; rel=\&quot;stylesheet\&quot;&gt;\n      &lt;link href=\&quot;/static/css/bootstrap-theme.min.css\&quot; rel=\&quot;stylesheet\&quot;&gt;\n      &lt;link href=\&quot;/static/css/hbase.css\&quot; rel=\&quot;stylesheet\&quot;&gt;\n      "</span>);
<a class="jxr_linenumber" name="104" href="#104">104</a>  <strong class="jxr_keyword">if</strong> ( ( !readOnly &amp;&amp; action != <strong class="jxr_keyword">null</strong> ) || fqtn == <strong class="jxr_keyword">null</strong> ) { 
<a class="jxr_linenumber" name="105" href="#105">105</a>       out.write(<span class="jxr_string">"\n\t  &lt;script type=\&quot;text/javascript\&quot;&gt;\n      &lt;!--\n\t\t  setTimeout(\&quot;history.back()\&quot;,5000);\n\t  --&gt;\n\t  &lt;/script&gt;\n      "</span>);
<a class="jxr_linenumber" name="106" href="#106">106</a>  } <strong class="jxr_keyword">else</strong> { 
<a class="jxr_linenumber" name="107" href="#107">107</a>       out.write(<span class="jxr_string">"\n      &lt;!--[if lt IE 9]&gt;\n          &lt;script src=\&quot;/static/js/html5shiv.js\&quot;&gt;&lt;/script&gt;\n      &lt;![endif]--&gt;\n      "</span>);
<a class="jxr_linenumber" name="108" href="#108">108</a>  } 
<a class="jxr_linenumber" name="109" href="#109">109</a>       out.write(<span class="jxr_string">"\n&lt;/head&gt;\n&lt;body&gt;\n&lt;div class=\&quot;navbar  navbar-fixed-top navbar-default\&quot;&gt;\n    &lt;div class=\&quot;container-fluid\&quot;&gt;\n        &lt;div class=\&quot;navbar-header\&quot;&gt;\n            &lt;button type=\&quot;button\&quot; class=\&quot;navbar-toggle\&quot; data-toggle=\&quot;collapse\&quot; data-target=\&quot;.navbar-collapse\&quot;&gt;\n                &lt;span class=\&quot;icon-bar\&quot;&gt;&lt;/span&gt;\n                &lt;span class=\&quot;icon-bar\&quot;&gt;&lt;/span&gt;\n                &lt;span class=\&quot;icon-bar\&quot;&gt;&lt;/span&gt;\n            &lt;/button&gt;\n            &lt;a class=\&quot;navbar-brand\&quot; href=\&quot;/master-status\&quot;&gt;&lt;img src=\&quot;/static/hbase_logo_small.png\&quot; alt=\&quot;HBase Logo\&quot;/&gt;&lt;/a&gt;\n        &lt;/div&gt;\n        &lt;div class=\&quot;collapse navbar-collapse\&quot;&gt;\n            &lt;ul class=\&quot;nav navbar-nav\&quot;&gt;\n                &lt;li&gt;&lt;a href=\&quot;/master-status\&quot;&gt;Home&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\&quot;/tablesDetailed.jsp\&quot;&gt;Table Details&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\&quot;/procedures.jsp\&quot;&gt;Procedures&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\&quot;/logs/\&quot;&gt;Local Logs&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\&quot;/logLevel\&quot;&gt;Log Level&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\&quot;/dump\&quot;&gt;Debug Dump&lt;/a&gt;&lt;/li&gt;\n                &lt;li&gt;&lt;a href=\&quot;/jmx\&quot;&gt;Metrics Dump&lt;/a&gt;&lt;/li&gt;\n"</span>);
<a class="jxr_linenumber" name="110" href="#110">110</a>       out.write(<span class="jxr_string">"                "</span>);
<a class="jxr_linenumber" name="111" href="#111">111</a>  <strong class="jxr_keyword">if</strong> (HBaseConfiguration.isShowConfInServlet()) { 
<a class="jxr_linenumber" name="112" href="#112">112</a>       out.write(<span class="jxr_string">"\n                &lt;li&gt;&lt;a href=\&quot;/conf\&quot;&gt;HBase Configuration&lt;/a&gt;&lt;/li&gt;\n                "</span>);
<a class="jxr_linenumber" name="113" href="#113">113</a>  } 
<a class="jxr_linenumber" name="114" href="#114">114</a>       out.write(<span class="jxr_string">"\n            &lt;/ul&gt;\n        &lt;/div&gt;&lt;!--/.nav-collapse --&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n"</span>);
<a class="jxr_linenumber" name="115" href="#115">115</a> 
<a class="jxr_linenumber" name="116" href="#116">116</a> <strong class="jxr_keyword">if</strong> ( fqtn != <strong class="jxr_keyword">null</strong> ) {
<a class="jxr_linenumber" name="117" href="#117">117</a>   table = (HTable) master.getConnection().getTable(TableName.valueOf(fqtn));
<a class="jxr_linenumber" name="118" href="#118">118</a>   <strong class="jxr_keyword">if</strong> (table.getTableDescriptor().getRegionReplication() &gt; 1) {
<a class="jxr_linenumber" name="119" href="#119">119</a>     tableHeader = <span class="jxr_string">"&lt;h2&gt;Table Regions&lt;/h2&gt;&lt;table class=\&quot;table table-striped\&quot; style=\&quot;table-layout: fixed; word-wrap: break-word;\&quot;&gt;&lt;tr&gt;&lt;th style=\&quot;width:22%\&quot;&gt;Name&lt;/th&gt;&lt;th&gt;Region Server&lt;/th&gt;&lt;th style=\&quot;width:22%\&quot;&gt;Start Key&lt;/th&gt;&lt;th style=\&quot;width:22%\&quot;&gt;End Key&lt;/th&gt;&lt;th&gt;Locality&lt;/th&gt;&lt;th&gt;Requests&lt;/th&gt;&lt;th&gt;ReplicaID&lt;/th&gt;&lt;/tr&gt;"</span>;
<a class="jxr_linenumber" name="120" href="#120">120</a>     withReplica = <strong class="jxr_keyword">true</strong>;
<a class="jxr_linenumber" name="121" href="#121">121</a>   } <strong class="jxr_keyword">else</strong> {
<a class="jxr_linenumber" name="122" href="#122">122</a>     tableHeader = <span class="jxr_string">"&lt;h2&gt;Table Regions&lt;/h2&gt;&lt;table class=\&quot;table table-striped\&quot; style=\&quot;table-layout: fixed; word-wrap: break-word;\&quot;&gt;&lt;tr&gt;&lt;th style=\&quot;width:22%\&quot;&gt;Name&lt;/th&gt;&lt;th&gt;Region Server&lt;/th&gt;&lt;th style=\&quot;width:22%\&quot;&gt;Start Key&lt;/th&gt;&lt;th style=\&quot;width:22%\&quot;&gt;End Key&lt;/th&gt;&lt;th&gt;Locality&lt;/th&gt;&lt;th&gt;Requests&lt;/th&gt;&lt;/tr&gt;"</span>;
<a class="jxr_linenumber" name="123" href="#123">123</a>   }
<a class="jxr_linenumber" name="124" href="#124">124</a>   <strong class="jxr_keyword">if</strong> ( !readOnly &amp;&amp; action != <strong class="jxr_keyword">null</strong> ) {
<a class="jxr_linenumber" name="125" href="#125">125</a> 
<a class="jxr_linenumber" name="126" href="#126">126</a>       out.write(<span class="jxr_string">"\n&lt;div class=\&quot;container-fluid content\&quot;&gt;\n        &lt;div class=\&quot;row inner_header\&quot;&gt;\n            &lt;div class=\&quot;page-header\&quot;&gt;\n                &lt;h1&gt;Table action request accepted&lt;/h1&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n&lt;p&gt;&lt;hr&gt;&lt;p&gt;\n"</span>);
<a class="jxr_linenumber" name="127" href="#127">127</a> 
<a class="jxr_linenumber" name="128" href="#128">128</a>   <strong class="jxr_keyword">try</strong> (Admin admin = master.getConnection().getAdmin()) {
<a class="jxr_linenumber" name="129" href="#129">129</a>     <strong class="jxr_keyword">if</strong> (action.equals(<span class="jxr_string">"split"</span>)) {
<a class="jxr_linenumber" name="130" href="#130">130</a>       <strong class="jxr_keyword">if</strong> (key != <strong class="jxr_keyword">null</strong> &amp;&amp; key.length() &gt; 0) {
<a class="jxr_linenumber" name="131" href="#131">131</a>         admin.splitRegion(Bytes.toBytes(key));
<a class="jxr_linenumber" name="132" href="#132">132</a>       } <strong class="jxr_keyword">else</strong> {
<a class="jxr_linenumber" name="133" href="#133">133</a>         admin.split(TableName.valueOf(fqtn));
<a class="jxr_linenumber" name="134" href="#134">134</a>       }
<a class="jxr_linenumber" name="135" href="#135">135</a> 
<a class="jxr_linenumber" name="136" href="#136">136</a>     
<a class="jxr_linenumber" name="137" href="#137">137</a>       out.write(<span class="jxr_string">" Split request accepted. "</span>);
<a class="jxr_linenumber" name="138" href="#138">138</a> 
<a class="jxr_linenumber" name="139" href="#139">139</a>     } <strong class="jxr_keyword">else</strong> <strong class="jxr_keyword">if</strong> (action.equals(<span class="jxr_string">"compact"</span>)) {
<a class="jxr_linenumber" name="140" href="#140">140</a>       <strong class="jxr_keyword">if</strong> (key != <strong class="jxr_keyword">null</strong> &amp;&amp; key.length() &gt; 0) {
<a class="jxr_linenumber" name="141" href="#141">141</a>         admin.compactRegion(Bytes.toBytes(key));
<a class="jxr_linenumber" name="142" href="#142">142</a>       } <strong class="jxr_keyword">else</strong> {
<a class="jxr_linenumber" name="143" href="#143">143</a>         admin.compact(TableName.valueOf(fqtn));
<a class="jxr_linenumber" name="144" href="#144">144</a>       }
<a class="jxr_linenumber" name="145" href="#145">145</a>     
<a class="jxr_linenumber" name="146" href="#146">146</a>       out.write(<span class="jxr_string">" Compact request accepted. "</span>);
<a class="jxr_linenumber" name="147" href="#147">147</a> 
<a class="jxr_linenumber" name="148" href="#148">148</a>     }
<a class="jxr_linenumber" name="149" href="#149">149</a>   }
<a class="jxr_linenumber" name="150" href="#150">150</a> 
<a class="jxr_linenumber" name="151" href="#151">151</a>       out.write(<span class="jxr_string">"\n&lt;p&gt;Go &lt;a href=\&quot;javascript:history.back()\&quot;&gt;Back&lt;/a&gt;, or wait for the redirect.\n&lt;/div&gt;\n"</span>);
<a class="jxr_linenumber" name="152" href="#152">152</a> 
<a class="jxr_linenumber" name="153" href="#153">153</a>   } <strong class="jxr_keyword">else</strong> {
<a class="jxr_linenumber" name="154" href="#154">154</a> 
<a class="jxr_linenumber" name="155" href="#155">155</a>       out.write(<span class="jxr_string">"\n&lt;div class=\&quot;container-fluid content\&quot;&gt;\n    &lt;div class=\&quot;row inner_header\&quot;&gt;\n        &lt;div class=\&quot;page-header\&quot;&gt;\n            &lt;h1&gt;Table &lt;small&gt;"</span>);
<a class="jxr_linenumber" name="156" href="#156">156</a>       out.print( ESAPI.encoder().encodeForHTML(fqtn) );
<a class="jxr_linenumber" name="157" href="#157">157</a>       out.write(<span class="jxr_string">"&lt;/small&gt;&lt;/h1&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div class=\&quot;row\&quot;&gt;\n"</span>);
<a class="jxr_linenumber" name="158" href="#158">158</a> 
<a class="jxr_linenumber" name="159" href="#159">159</a>   <strong class="jxr_keyword">if</strong>(fqtn.equals(TableName.META_TABLE_NAME.getNameAsString())) {
<a class="jxr_linenumber" name="160" href="#160">160</a> 
<a class="jxr_linenumber" name="161" href="#161">161</a>       out.write('\n');
<a class="jxr_linenumber" name="162" href="#162">162</a>       out.print( tableHeader );
<a class="jxr_linenumber" name="163" href="#163">163</a>       out.write('\n');
<a class="jxr_linenumber" name="164" href="#164">164</a> 
<a class="jxr_linenumber" name="165" href="#165">165</a>   <em class="jxr_comment">// NOTE: Presumes meta with one or more replicas</em>
<a class="jxr_linenumber" name="166" href="#166">166</a>   <strong class="jxr_keyword">for</strong> (<strong class="jxr_keyword">int</strong> j = 0; j &lt; numMetaReplicas; j++) {
<a class="jxr_linenumber" name="167" href="#167">167</a>     <a href="../../../../../../org/apache/hadoop/hbase/HRegionInfo.html">HRegionInfo</a> meta = RegionReplicaUtil.getRegionInfoForReplica(
<a class="jxr_linenumber" name="168" href="#168">168</a>                             HRegionInfo.FIRST_META_REGIONINFO, j);
<a class="jxr_linenumber" name="169" href="#169">169</a>     <a href="../../../../../../org/apache/hadoop/hbase/ServerName.html">ServerName</a> metaLocation = metaTableLocator.waitMetaRegionLocation(master.getZooKeeper(), j, 1);
<a class="jxr_linenumber" name="170" href="#170">170</a>     <strong class="jxr_keyword">for</strong> (<strong class="jxr_keyword">int</strong> i = 0; i &lt; 1; i++) {
<a class="jxr_linenumber" name="171" href="#171">171</a>       String url = <span class="jxr_string">"//"</span> + metaLocation.getHostname() + <span class="jxr_string">":"</span> +
<a class="jxr_linenumber" name="172" href="#172">172</a>                    master.getRegionServerInfoPort(metaLocation) + <span class="jxr_string">"/"</span>;
<a class="jxr_linenumber" name="173" href="#173">173</a> 
<a class="jxr_linenumber" name="174" href="#174">174</a>       out.write(<span class="jxr_string">"\n&lt;tr&gt;\n  &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="175" href="#175">175</a>       out.print( escapeXml(meta.getRegionNameAsString()) );
<a class="jxr_linenumber" name="176" href="#176">176</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n    &lt;td&gt;&lt;a href=\&quot;"</span>);
<a class="jxr_linenumber" name="177" href="#177">177</a>       out.print( url );
<a class="jxr_linenumber" name="178" href="#178">178</a>       out.write('&quot;');
<a class="jxr_linenumber" name="179" href="#179">179</a>       out.write('&gt;');
<a class="jxr_linenumber" name="180" href="#180">180</a>       out.print( metaLocation.getHostname().toString() + <span class="jxr_string">":"</span> + master.getRegionServerInfoPort(metaLocation) );
<a class="jxr_linenumber" name="181" href="#181">181</a>       out.write(<span class="jxr_string">"&lt;/a&gt;&lt;/td&gt;\n    &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="182" href="#182">182</a>       out.print( escapeXml(Bytes.toString(meta.getStartKey())) );
<a class="jxr_linenumber" name="183" href="#183">183</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n    &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="184" href="#184">184</a>       out.print( escapeXml(Bytes.toString(meta.getEndKey())) );
<a class="jxr_linenumber" name="185" href="#185">185</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n    &lt;td&gt;-&lt;/td&gt;\n&lt;/tr&gt;\n"</span>);
<a class="jxr_linenumber" name="186" href="#186">186</a>   } 
<a class="jxr_linenumber" name="187" href="#187">187</a>       out.write('\n');
<a class="jxr_linenumber" name="188" href="#188">188</a> } 
<a class="jxr_linenumber" name="189" href="#189">189</a>       out.write(<span class="jxr_string">"\n&lt;/table&gt;\n"</span>);
<a class="jxr_linenumber" name="190" href="#190">190</a> } <strong class="jxr_keyword">else</strong> {
<a class="jxr_linenumber" name="191" href="#191">191</a>   <a href="../../../../../../org/apache/hadoop/hbase/client/Admin.html">Admin</a> admin = master.getConnection().getAdmin();
<a class="jxr_linenumber" name="192" href="#192">192</a>   <a href="../../../../../../org/apache/hadoop/hbase/client/RegionLocator.html">RegionLocator</a> r = master.getClusterConnection().getRegionLocator(table.getName());
<a class="jxr_linenumber" name="193" href="#193">193</a>   <strong class="jxr_keyword">try</strong> { 
<a class="jxr_linenumber" name="194" href="#194">194</a>       out.write(<span class="jxr_string">"\n&lt;h2&gt;Table Attributes&lt;/h2&gt;\n&lt;table class=\&quot;table table-striped\&quot;&gt;\n  &lt;tr&gt;\n      &lt;th&gt;Attribute Name&lt;/th&gt;\n      &lt;th&gt;Value&lt;/th&gt;\n      &lt;th&gt;Description&lt;/th&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n      &lt;td&gt;Enabled&lt;/td&gt;\n      &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="195" href="#195">195</a>       out.print( admin.isTableEnabled(table.getName()) );
<a class="jxr_linenumber" name="196" href="#196">196</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n      &lt;td&gt;Is the table enabled&lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n      &lt;td&gt;Compaction&lt;/td&gt;\n      &lt;td&gt;\n"</span>);
<a class="jxr_linenumber" name="197" href="#197">197</a> 
<a class="jxr_linenumber" name="198" href="#198">198</a>   <strong class="jxr_keyword">try</strong> {
<a class="jxr_linenumber" name="199" href="#199">199</a>     CompactionState compactionState = admin.getCompactionState(table.getName());
<a class="jxr_linenumber" name="200" href="#200">200</a> 
<a class="jxr_linenumber" name="201" href="#201">201</a>       out.write('\n');
<a class="jxr_linenumber" name="202" href="#202">202</a>       out.print( compactionState );
<a class="jxr_linenumber" name="203" href="#203">203</a>       out.write('\n');
<a class="jxr_linenumber" name="204" href="#204">204</a> 
<a class="jxr_linenumber" name="205" href="#205">205</a>   } <strong class="jxr_keyword">catch</strong> (Exception e) {
<a class="jxr_linenumber" name="206" href="#206">206</a>   <em class="jxr_comment">// Nothing really to do here</em>
<a class="jxr_linenumber" name="207" href="#207">207</a>     e.printStackTrace();
<a class="jxr_linenumber" name="208" href="#208">208</a> 
<a class="jxr_linenumber" name="209" href="#209">209</a>       out.write(<span class="jxr_string">" Unknown "</span>);
<a class="jxr_linenumber" name="210" href="#210">210</a> 
<a class="jxr_linenumber" name="211" href="#211">211</a>   }
<a class="jxr_linenumber" name="212" href="#212">212</a> 
<a class="jxr_linenumber" name="213" href="#213">213</a>       out.write(<span class="jxr_string">"\n      &lt;/td&gt;\n      &lt;td&gt;Is the table compacting&lt;/td&gt;\n  &lt;/tr&gt;\n"</span>);
<a class="jxr_linenumber" name="214" href="#214">214</a>   <strong class="jxr_keyword">if</strong> (showFragmentation) { 
<a class="jxr_linenumber" name="215" href="#215">215</a>       out.write(<span class="jxr_string">"\n  &lt;tr&gt;\n      &lt;td&gt;Fragmentation&lt;/td&gt;\n      &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="216" href="#216">216</a>       out.print( frags.get(fqtn) != <strong class="jxr_keyword">null</strong> ? frags.get(fqtn).intValue() + <span class="jxr_string">"%"</span> : <span class="jxr_string">"n/a"</span> );
<a class="jxr_linenumber" name="217" href="#217">217</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n      &lt;td&gt;How fragmented is the table. After a major compaction it is 0%.&lt;/td&gt;\n  &lt;/tr&gt;\n"</span>);
<a class="jxr_linenumber" name="218" href="#218">218</a>   } 
<a class="jxr_linenumber" name="219" href="#219">219</a>       out.write(<span class="jxr_string">"\n&lt;/table&gt;\n&lt;h2&gt;Table Schema&lt;/h2&gt;\n&lt;table class=\&quot;table table-striped\&quot;&gt;\n  &lt;tr&gt;\n      &lt;th&gt;Column Name&lt;/th&gt;\n      &lt;th&gt;&lt;/th&gt;\n  &lt;/tr&gt;\n  "</span>);
<a class="jxr_linenumber" name="220" href="#220">220</a> 
<a class="jxr_linenumber" name="221" href="#221">221</a>     Collection&lt;HColumnDescriptor&gt; families = table.getTableDescriptor().getFamilies();
<a class="jxr_linenumber" name="222" href="#222">222</a>     <strong class="jxr_keyword">for</strong> (HColumnDescriptor family: families) {
<a class="jxr_linenumber" name="223" href="#223">223</a>   
<a class="jxr_linenumber" name="224" href="#224">224</a>       out.write(<span class="jxr_string">"\n  &lt;tr&gt;\n    &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="225" href="#225">225</a>       out.print( family.getNameAsString() );
<a class="jxr_linenumber" name="226" href="#226">226</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n    &lt;td&gt;\n    &lt;table class=\&quot;table table-striped\&quot;&gt;\n      &lt;tr&gt;\n       &lt;th&gt;Property&lt;/th&gt;\n       &lt;th&gt;Value&lt;/th&gt;\n      &lt;/tr&gt;\n    "</span>);
<a class="jxr_linenumber" name="227" href="#227">227</a> 
<a class="jxr_linenumber" name="228" href="#228">228</a>     Map&lt;Bytes, Bytes&gt; familyValues = family.getValues();
<a class="jxr_linenumber" name="229" href="#229">229</a>     <strong class="jxr_keyword">for</strong> (Bytes familyKey: familyValues.keySet()) {
<a class="jxr_linenumber" name="230" href="#230">230</a>     
<a class="jxr_linenumber" name="231" href="#231">231</a>       out.write(<span class="jxr_string">"\n      &lt;tr&gt;\n        &lt;td&gt;\n          "</span>);
<a class="jxr_linenumber" name="232" href="#232">232</a>       out.print( familyKey );
<a class="jxr_linenumber" name="233" href="#233">233</a>       out.write(<span class="jxr_string">"\n\t\t&lt;/td&gt;\n        &lt;td&gt;\n          "</span>);
<a class="jxr_linenumber" name="234" href="#234">234</a>       out.print( familyValues.get(familyKey) );
<a class="jxr_linenumber" name="235" href="#235">235</a>       out.write(<span class="jxr_string">"\n        &lt;/td&gt;\n      &lt;/tr&gt;\n    "</span>);
<a class="jxr_linenumber" name="236" href="#236">236</a>  } 
<a class="jxr_linenumber" name="237" href="#237">237</a>       out.write(<span class="jxr_string">"\n    &lt;/table&gt;\n    &lt;/td&gt;\n  &lt;/tr&gt;\n  "</span>);
<a class="jxr_linenumber" name="238" href="#238">238</a>  } 
<a class="jxr_linenumber" name="239" href="#239">239</a>       out.write(<span class="jxr_string">"\n&lt;/table&gt;\n"</span>);
<a class="jxr_linenumber" name="240" href="#240">240</a> 
<a class="jxr_linenumber" name="241" href="#241">241</a>   Map&lt;ServerName, Integer&gt; regDistribution = <strong class="jxr_keyword">new</strong> TreeMap&lt;ServerName, Integer&gt;();
<a class="jxr_linenumber" name="242" href="#242">242</a>   Map&lt;ServerName, Integer&gt; primaryRegDistribution = <strong class="jxr_keyword">new</strong> TreeMap&lt;ServerName, Integer&gt;();
<a class="jxr_linenumber" name="243" href="#243">243</a>   List&lt;HRegionLocation&gt; regions = r.getAllRegionLocations();
<a class="jxr_linenumber" name="244" href="#244">244</a>   <strong class="jxr_keyword">if</strong>(regions != <strong class="jxr_keyword">null</strong> &amp;&amp; regions.size() &gt; 0) { 
<a class="jxr_linenumber" name="245" href="#245">245</a>       out.write('\n');
<a class="jxr_linenumber" name="246" href="#246">246</a>       out.print(     tableHeader );
<a class="jxr_linenumber" name="247" href="#247">247</a>       out.write('\n');
<a class="jxr_linenumber" name="248" href="#248">248</a> 
<a class="jxr_linenumber" name="249" href="#249">249</a>   <strong class="jxr_keyword">for</strong> (HRegionLocation hriEntry : regions) {
<a class="jxr_linenumber" name="250" href="#250">250</a>     <a href="../../../../../../org/apache/hadoop/hbase/HRegionInfo.html">HRegionInfo</a> regionInfo = hriEntry.getRegionInfo();
<a class="jxr_linenumber" name="251" href="#251">251</a>     <a href="../../../../../../org/apache/hadoop/hbase/ServerName.html">ServerName</a> addr = hriEntry.getServerName();
<a class="jxr_linenumber" name="252" href="#252">252</a>     <strong class="jxr_keyword">long</strong> req = 0;
<a class="jxr_linenumber" name="253" href="#253">253</a>     <strong class="jxr_keyword">float</strong> locality = 0.0f;
<a class="jxr_linenumber" name="254" href="#254">254</a>     String urlRegionServer = <strong class="jxr_keyword">null</strong>;
<a class="jxr_linenumber" name="255" href="#255">255</a> 
<a class="jxr_linenumber" name="256" href="#256">256</a>     <strong class="jxr_keyword">if</strong> (addr != <strong class="jxr_keyword">null</strong>) {
<a class="jxr_linenumber" name="257" href="#257">257</a>       <a href="../../../../../../org/apache/hadoop/hbase/ServerLoad.html">ServerLoad</a> sl = master.getServerManager().getLoad(addr);
<a class="jxr_linenumber" name="258" href="#258">258</a>       <strong class="jxr_keyword">if</strong> (sl != <strong class="jxr_keyword">null</strong>) {
<a class="jxr_linenumber" name="259" href="#259">259</a>         Map&lt;byte[], RegionLoad&gt; map = sl.getRegionsLoad();
<a class="jxr_linenumber" name="260" href="#260">260</a>         <strong class="jxr_keyword">if</strong> (map.containsKey(regionInfo.getRegionName())) {
<a class="jxr_linenumber" name="261" href="#261">261</a>           req = map.get(regionInfo.getRegionName()).getRequestsCount();
<a class="jxr_linenumber" name="262" href="#262">262</a>           locality = map.get(regionInfo.getRegionName()).getDataLocality();
<a class="jxr_linenumber" name="263" href="#263">263</a>         }
<a class="jxr_linenumber" name="264" href="#264">264</a>         Integer i = regDistribution.get(addr);
<a class="jxr_linenumber" name="265" href="#265">265</a>         <strong class="jxr_keyword">if</strong> (<strong class="jxr_keyword">null</strong> == i) i = Integer.valueOf(0);
<a class="jxr_linenumber" name="266" href="#266">266</a>         regDistribution.put(addr, i + 1);
<a class="jxr_linenumber" name="267" href="#267">267</a>         <strong class="jxr_keyword">if</strong> (withReplica &amp;&amp; RegionReplicaUtil.isDefaultReplica(regionInfo.getReplicaId())) {
<a class="jxr_linenumber" name="268" href="#268">268</a>           i = primaryRegDistribution.get(addr);
<a class="jxr_linenumber" name="269" href="#269">269</a>           <strong class="jxr_keyword">if</strong> (<strong class="jxr_keyword">null</strong> == i) i = Integer.valueOf(0);
<a class="jxr_linenumber" name="270" href="#270">270</a>           primaryRegDistribution.put(addr, i+1);
<a class="jxr_linenumber" name="271" href="#271">271</a>         }
<a class="jxr_linenumber" name="272" href="#272">272</a>       }
<a class="jxr_linenumber" name="273" href="#273">273</a>     }
<a class="jxr_linenumber" name="274" href="#274">274</a> 
<a class="jxr_linenumber" name="275" href="#275">275</a>       out.write(<span class="jxr_string">"\n&lt;tr&gt;\n  &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="276" href="#276">276</a>       out.print( escapeXml(Bytes.toStringBinary(HRegionInfo.getRegionNameForDisplay(regionInfo,
<a class="jxr_linenumber" name="277" href="#277">277</a>                     conf))) );
<a class="jxr_linenumber" name="278" href="#278">278</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n  "</span>);
<a class="jxr_linenumber" name="279" href="#279">279</a> 
<a class="jxr_linenumber" name="280" href="#280">280</a>   <strong class="jxr_keyword">if</strong> (addr != <strong class="jxr_keyword">null</strong>) {
<a class="jxr_linenumber" name="281" href="#281">281</a>     String url = <span class="jxr_string">"//"</span> + addr.getHostname() + <span class="jxr_string">":"</span> + master.getRegionServerInfoPort(addr) + <span class="jxr_string">"/rs-status"</span>;
<a class="jxr_linenumber" name="282" href="#282">282</a>   
<a class="jxr_linenumber" name="283" href="#283">283</a>       out.write(<span class="jxr_string">"\n  &lt;td&gt;\n     &lt;a href=\&quot;"</span>);
<a class="jxr_linenumber" name="284" href="#284">284</a>       out.print( url );
<a class="jxr_linenumber" name="285" href="#285">285</a>       out.write('&quot;');
<a class="jxr_linenumber" name="286" href="#286">286</a>       out.write('&gt;');
<a class="jxr_linenumber" name="287" href="#287">287</a>       out.print( addr.getHostname().toString() + <span class="jxr_string">":"</span> + addr.getPort() );
<a class="jxr_linenumber" name="288" href="#288">288</a>       out.write(<span class="jxr_string">"&lt;/a&gt;\n  &lt;/td&gt;\n  "</span>);
<a class="jxr_linenumber" name="289" href="#289">289</a> 
<a class="jxr_linenumber" name="290" href="#290">290</a>   } <strong class="jxr_keyword">else</strong> {
<a class="jxr_linenumber" name="291" href="#291">291</a>   
<a class="jxr_linenumber" name="292" href="#292">292</a>       out.write(<span class="jxr_string">"\n  &lt;td class=\&quot;undeployed-region\&quot;&gt;not deployed&lt;/td&gt;\n  "</span>);
<a class="jxr_linenumber" name="293" href="#293">293</a> 
<a class="jxr_linenumber" name="294" href="#294">294</a>   }
<a class="jxr_linenumber" name="295" href="#295">295</a>   
<a class="jxr_linenumber" name="296" href="#296">296</a>       out.write(<span class="jxr_string">"\n  &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="297" href="#297">297</a>       out.print( escapeXml(Bytes.toStringBinary(HRegionInfo.getStartKeyForDisplay(regionInfo,
<a class="jxr_linenumber" name="298" href="#298">298</a>                     conf))) );
<a class="jxr_linenumber" name="299" href="#299">299</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n  &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="300" href="#300">300</a>       out.print( escapeXml(Bytes.toStringBinary(HRegionInfo.getEndKeyForDisplay(regionInfo,
<a class="jxr_linenumber" name="301" href="#301">301</a>                     conf))) );
<a class="jxr_linenumber" name="302" href="#302">302</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n  &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="303" href="#303">303</a>       out.print( locality);
<a class="jxr_linenumber" name="304" href="#304">304</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n  &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="305" href="#305">305</a>       out.print( req);
<a class="jxr_linenumber" name="306" href="#306">306</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n  "</span>);
<a class="jxr_linenumber" name="307" href="#307">307</a> 
<a class="jxr_linenumber" name="308" href="#308">308</a>   <strong class="jxr_keyword">if</strong> (withReplica) {
<a class="jxr_linenumber" name="309" href="#309">309</a>   
<a class="jxr_linenumber" name="310" href="#310">310</a>       out.write(<span class="jxr_string">"\n  &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="311" href="#311">311</a>       out.print( regionInfo.getReplicaId() );
<a class="jxr_linenumber" name="312" href="#312">312</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n  "</span>);
<a class="jxr_linenumber" name="313" href="#313">313</a> 
<a class="jxr_linenumber" name="314" href="#314">314</a>   }
<a class="jxr_linenumber" name="315" href="#315">315</a>   
<a class="jxr_linenumber" name="316" href="#316">316</a>       out.write(<span class="jxr_string">"\n&lt;/tr&gt;\n"</span>);
<a class="jxr_linenumber" name="317" href="#317">317</a>  } 
<a class="jxr_linenumber" name="318" href="#318">318</a>       out.write(<span class="jxr_string">"\n&lt;/table&gt;\n&lt;h2&gt;Regions by Region Server&lt;/h2&gt;\n"</span>);
<a class="jxr_linenumber" name="319" href="#319">319</a> 
<a class="jxr_linenumber" name="320" href="#320">320</a> <strong class="jxr_keyword">if</strong> (withReplica) {
<a class="jxr_linenumber" name="321" href="#321">321</a> 
<a class="jxr_linenumber" name="322" href="#322">322</a>       out.write(<span class="jxr_string">"\n&lt;table class=\&quot;table table-striped\&quot;&gt;&lt;tr&gt;&lt;th&gt;Region Server&lt;/th&gt;&lt;th&gt;Region Count&lt;/th&gt;&lt;th&gt;Primary Region Count&lt;/th&gt;&lt;/tr&gt;\n"</span>);
<a class="jxr_linenumber" name="323" href="#323">323</a> 
<a class="jxr_linenumber" name="324" href="#324">324</a> } <strong class="jxr_keyword">else</strong> {
<a class="jxr_linenumber" name="325" href="#325">325</a> 
<a class="jxr_linenumber" name="326" href="#326">326</a>       out.write(<span class="jxr_string">"\n&lt;table class=\&quot;table table-striped\&quot;&gt;&lt;tr&gt;&lt;th&gt;Region Server&lt;/th&gt;&lt;th&gt;Region Count&lt;/th&gt;&lt;/tr&gt;\n"</span>);
<a class="jxr_linenumber" name="327" href="#327">327</a> 
<a class="jxr_linenumber" name="328" href="#328">328</a> }
<a class="jxr_linenumber" name="329" href="#329">329</a> 
<a class="jxr_linenumber" name="330" href="#330">330</a>       out.write('\n');
<a class="jxr_linenumber" name="331" href="#331">331</a> 
<a class="jxr_linenumber" name="332" href="#332">332</a>   <strong class="jxr_keyword">for</strong> (Map.Entry&lt;ServerName, Integer&gt; rdEntry : regDistribution.entrySet()) {
<a class="jxr_linenumber" name="333" href="#333">333</a>      <a href="../../../../../../org/apache/hadoop/hbase/ServerName.html">ServerName</a> addr = rdEntry.getKey();
<a class="jxr_linenumber" name="334" href="#334">334</a>      String url = <span class="jxr_string">"//"</span> + addr.getHostname() + <span class="jxr_string">":"</span> + master.getRegionServerInfoPort(addr) + <span class="jxr_string">"/"</span>;
<a class="jxr_linenumber" name="335" href="#335">335</a> 
<a class="jxr_linenumber" name="336" href="#336">336</a>       out.write(<span class="jxr_string">"\n&lt;tr&gt;\n  &lt;td&gt;&lt;a href=\&quot;"</span>);
<a class="jxr_linenumber" name="337" href="#337">337</a>       out.print( url );
<a class="jxr_linenumber" name="338" href="#338">338</a>       out.write('&quot;');
<a class="jxr_linenumber" name="339" href="#339">339</a>       out.write('&gt;');
<a class="jxr_linenumber" name="340" href="#340">340</a>       out.print( addr.getHostname().toString() + <span class="jxr_string">":"</span> + addr.getPort() );
<a class="jxr_linenumber" name="341" href="#341">341</a>       out.write(<span class="jxr_string">"&lt;/a&gt;&lt;/td&gt;\n  &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="342" href="#342">342</a>       out.print( rdEntry.getValue());
<a class="jxr_linenumber" name="343" href="#343">343</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n"</span>);
<a class="jxr_linenumber" name="344" href="#344">344</a> 
<a class="jxr_linenumber" name="345" href="#345">345</a> <strong class="jxr_keyword">if</strong> (withReplica) {
<a class="jxr_linenumber" name="346" href="#346">346</a> 
<a class="jxr_linenumber" name="347" href="#347">347</a>       out.write(<span class="jxr_string">"\n  &lt;td&gt;"</span>);
<a class="jxr_linenumber" name="348" href="#348">348</a>       out.print( primaryRegDistribution.get(addr));
<a class="jxr_linenumber" name="349" href="#349">349</a>       out.write(<span class="jxr_string">"&lt;/td&gt;\n"</span>);
<a class="jxr_linenumber" name="350" href="#350">350</a> 
<a class="jxr_linenumber" name="351" href="#351">351</a> }
<a class="jxr_linenumber" name="352" href="#352">352</a> 
<a class="jxr_linenumber" name="353" href="#353">353</a>       out.write(<span class="jxr_string">"\n&lt;/tr&gt;\n"</span>);
<a class="jxr_linenumber" name="354" href="#354">354</a>  } 
<a class="jxr_linenumber" name="355" href="#355">355</a>       out.write(<span class="jxr_string">"\n&lt;/table&gt;\n"</span>);
<a class="jxr_linenumber" name="356" href="#356">356</a>  }
<a class="jxr_linenumber" name="357" href="#357">357</a> } <strong class="jxr_keyword">catch</strong>(Exception ex) {
<a class="jxr_linenumber" name="358" href="#358">358</a>   ex.printStackTrace(System.err);
<a class="jxr_linenumber" name="359" href="#359">359</a> } <strong class="jxr_keyword">finally</strong> {
<a class="jxr_linenumber" name="360" href="#360">360</a>   admin.close();
<a class="jxr_linenumber" name="361" href="#361">361</a> }
<a class="jxr_linenumber" name="362" href="#362">362</a> } <em class="jxr_comment">// end else</em>
<a class="jxr_linenumber" name="363" href="#363">363</a> 
<a class="jxr_linenumber" name="364" href="#364">364</a>       out.write(<span class="jxr_string">"\n\n\n"</span>);
<a class="jxr_linenumber" name="365" href="#365">365</a>  <strong class="jxr_keyword">if</strong> (!readOnly) { 
<a class="jxr_linenumber" name="366" href="#366">366</a>       out.write(<span class="jxr_string">"\n&lt;p&gt;&lt;hr/&gt;&lt;/p&gt;\nActions:\n&lt;p&gt;\n&lt;center&gt;\n&lt;table class=\&quot;table\&quot; width=\&quot;95%\&quot; &gt;\n&lt;tr&gt;\n  &lt;form method=\&quot;get\&quot;&gt;\n  &lt;input type=\&quot;hidden\&quot; name=\&quot;action\&quot; value=\&quot;compact\&quot;&gt;\n  &lt;input type=\&quot;hidden\&quot; name=\&quot;name\&quot; value=\&quot;"</span>);
<a class="jxr_linenumber" name="367" href="#367">367</a>       out.print( fqtn );
<a class="jxr_linenumber" name="368" href="#368">368</a>       out.write(<span class="jxr_string">"\&quot;&gt;\n  &lt;td style=\&quot;border-style: none; text-align: center\&quot;&gt;\n      &lt;input style=\&quot;font-size: 12pt; width: 10em\&quot; type=\&quot;submit\&quot; value=\&quot;Compact\&quot; class=\&quot;btn\&quot;&gt;&lt;/td&gt;\n  &lt;td style=\&quot;border-style: none\&quot; width=\&quot;5%\&quot;&gt;&amp;nbsp;&lt;/td&gt;\n  &lt;td style=\&quot;border-style: none\&quot;&gt;Region Key (optional):&lt;input type=\&quot;text\&quot; name=\&quot;key\&quot; size=\&quot;40\&quot;&gt;&lt;/td&gt;\n  &lt;td style=\&quot;border-style: none\&quot;&gt;This action will force a compaction of all\n  regions of the table, or, if a key is supplied, only the region containing the\n  given key.&lt;/td&gt;\n  &lt;/form&gt;\n&lt;/tr&gt;\n&lt;tr&gt;&lt;td style=\&quot;border-style: none\&quot; colspan=\&quot;4\&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;\n&lt;tr&gt;\n  &lt;form method=\&quot;get\&quot;&gt;\n  &lt;input type=\&quot;hidden\&quot; name=\&quot;action\&quot; value=\&quot;split\&quot;&gt;\n  &lt;input type=\&quot;hidden\&quot; name=\&quot;name\&quot; value=\&quot;"</span>);
<a class="jxr_linenumber" name="369" href="#369">369</a>       out.print( fqtn );
<a class="jxr_linenumber" name="370" href="#370">370</a>       out.write(<span class="jxr_string">"\&quot;&gt;\n  &lt;td style=\&quot;border-style: none; text-align: center\&quot;&gt;\n      &lt;input style=\&quot;font-size: 12pt; width: 10em\&quot; type=\&quot;submit\&quot; value=\&quot;Split\&quot; class=\&quot;btn\&quot;&gt;&lt;/td&gt;\n  &lt;td style=\&quot;border-style: none\&quot; width=\&quot;5%\&quot;&gt;&amp;nbsp;&lt;/td&gt;\n  &lt;td style=\&quot;border-style: none\&quot;&gt;Region Key (optional):&lt;input type=\&quot;text\&quot; name=\&quot;key\&quot; size=\&quot;40\&quot;&gt;&lt;/td&gt;\n  &lt;td style=\&quot;border-style: none\&quot;&gt;This action will force a split of all eligible\n  regions of the table, or, if a key is supplied, only the region containing the\n  given key. An eligible region is one that does not contain any references to\n  other regions. Split requests for noneligible regions will be ignored.&lt;/td&gt;\n  &lt;/form&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n&lt;/center&gt;\n&lt;/p&gt;\n"</span>);
<a class="jxr_linenumber" name="371" href="#371">371</a>  } 
<a class="jxr_linenumber" name="372" href="#372">372</a>       out.write(<span class="jxr_string">"\n&lt;/div&gt;\n&lt;/div&gt;\n"</span>);
<a class="jxr_linenumber" name="373" href="#373">373</a>  }
<a class="jxr_linenumber" name="374" href="#374">374</a> } <strong class="jxr_keyword">else</strong> { <em class="jxr_comment">// handle the case for fqtn is null with error message + redirect</em>
<a class="jxr_linenumber" name="375" href="#375">375</a> 
<a class="jxr_linenumber" name="376" href="#376">376</a>       out.write(<span class="jxr_string">"\n&lt;div class=\&quot;container-fluid content\&quot;&gt;\n    &lt;div class=\&quot;row inner_header\&quot;&gt;\n        &lt;div class=\&quot;page-header\&quot;&gt;\n            &lt;h1&gt;Table not ready&lt;/h1&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;p&gt;&lt;hr&gt;&lt;p&gt;\n&lt;p&gt;Go &lt;a href=\&quot;javascript:history.back()\&quot;&gt;Back&lt;/a&gt;, or wait for the redirect.\n&lt;/div&gt;\n"</span>);
<a class="jxr_linenumber" name="377" href="#377">377</a>  } 
<a class="jxr_linenumber" name="378" href="#378">378</a>       out.write(<span class="jxr_string">"\n&lt;script src=\&quot;/static/js/jquery.min.js\&quot; type=\&quot;text/javascript\&quot;&gt;&lt;/script&gt;\n&lt;script src=\&quot;/static/js/bootstrap.min.js\&quot; type=\&quot;text/javascript\&quot;&gt;&lt;/script&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n"</span>);
<a class="jxr_linenumber" name="379" href="#379">379</a>     } <strong class="jxr_keyword">catch</strong> (Throwable t) {
<a class="jxr_linenumber" name="380" href="#380">380</a>       <strong class="jxr_keyword">if</strong> (!(t instanceof SkipPageException)){
<a class="jxr_linenumber" name="381" href="#381">381</a>         out = _jspx_out;
<a class="jxr_linenumber" name="382" href="#382">382</a>         <strong class="jxr_keyword">if</strong> (out != <strong class="jxr_keyword">null</strong> &amp;&amp; out.getBufferSize() != 0)
<a class="jxr_linenumber" name="383" href="#383">383</a>           out.clearBuffer();
<a class="jxr_linenumber" name="384" href="#384">384</a>         <strong class="jxr_keyword">if</strong> (_jspx_page_context != <strong class="jxr_keyword">null</strong>) _jspx_page_context.handlePageException(t);
<a class="jxr_linenumber" name="385" href="#385">385</a>       }
<a class="jxr_linenumber" name="386" href="#386">386</a>     } <strong class="jxr_keyword">finally</strong> {
<a class="jxr_linenumber" name="387" href="#387">387</a>       _jspxFactory.releasePageContext(_jspx_page_context);
<a class="jxr_linenumber" name="388" href="#388">388</a>     }
<a class="jxr_linenumber" name="389" href="#389">389</a>   }
<a class="jxr_linenumber" name="390" href="#390">390</a> }
</pre>
<hr/><div id="footer">This page was automatically generated by <a href="http://maven.apache.org/">Maven</a></div></body>
</html>

